#!/usr/bin/env python
# -*- coding: utf-8 -*-

"""
###################################################################################################################
This script read epochs, cos_similarities data, and plot them.
The Training-01-all21-N-Human345_Cyno76-Full_Semi.
Train-Human/Cyno-N

Testing-01-N-2202-P4M.
Test-Human-N-SCE

The batch sizes are 8, 16, 32, 64, 128, learning rates are 1, 1, 2, 4, 8.

Created on 03 November 2022.
###################################################################################################################
"""
__author__ = 'ZLiang'

import matplotlib.pyplot as plt
import numpy as np

# Cosine similarities for different test cases. Totally 50 scores for each test.
# These are used for the y-axis.
# The values are from the epochs of
#   1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26,
#   27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50.

#test_1_8_median = [0.907395, 0.904357, 0.909728, 0.913999, 0.904275, 0.905619, 0.907779, 0.904356, 0.897990, 0.906158,
#                    ]

test_1_16_1_median = [0.9576141708712809, 0.9611037119001646, 0.9628435762298901, 0.9630409957365234, 0.9636411129259699,
                    0.9629141581847322, 0.9648392137995877, 0.9640165863743329, 0.9637022891459792, 0.9640328499553021,
                    0.96472335518696,   0.9638156212526949, 0.9635711435865364, 0.9645769722696609, 0.9646660767427837,
                    0.964272555804442,  0.96462073438858,   0.9653036644971607, 0.9654132618784956, 0.9644465950569727,
                    0.9648781251617091, 0.9647312338019214, 0.9656060359584937, 0.9654652207723106, 0.9647215632172215,
                    0.965140400178605,  0.9656704914100298, 0.9646063409829323, 0.9641105556346456, 0.9653069338055127,
                    0.9650393902667833, 0.9645567783640945, 0.9645622364557994, 0.9649966322596988, 0.964350063957265,
                    0.964295724560944,  0.9655909453601805, 0.9649171195919523, 0.9650005566635231, 0.9644862396542899,
                    0.9654879923425441, 0.9640125619114526, 0.9645962204860588, 0.9650506277409769, 0.9639925223960231,
                    0.9655697609160538, 0.9652018138623877, 0.9655597149462533, 0.9652250885360463, 0.9650568516818417,
                    ]

test_1_16_2_median = [0.9601677155422521, 0.9627094967051231, 0.9632804316144588, 0.9628073115018021, 0.9628054099202215,
                    0.9633326575197272, 0.9650455954260434, 0.9623560936766697, 0.9650002738616918, 0.9637551205370092,
                    0.9648337440912259, 0.9644798593687702, 0.9641574571685059, 0.9640501633247722, 0.963974254491988,
                    0.9639318304909723, 0.9646645105182428, 0.9643998976283399, 0.9642451012072035, 0.9630260911029153,
                    0.9642602408926823, 0.9652316704018993, 0.9644282640023649, 0.965023989160885,  0.9642706091804176,
                    0.9648635025069315, 0.9657069341409343, 0.9649598674269607, 0.9648198606320428, 0.9648867180173704,
                    0.964637275414363,  0.963921441660604,  0.9648266243697866, 0.9647754949076277, 0.9643419319520563,
                    0.9646663053588082, 0.9638661812593219, 0.9639885514191908, 0.9653077400841197, 0.9651934900908304,
                    0.9644456856682252, 0.9653633281173657, 0.9644939013350198, 0.9647250408755517, 0.9645288965651584,
                    0.9647676521588864, 0.9643401025981384, 0.9652522709499981, 0.964640181075574,  0.965362720254688,
                    ]

test_1_32_2_median = [0.9559930551076132, 0.9597495922238889, 0.9623064676431463, 0.9637279272463561, 0.9626135404442395,
                    0.9635742464190504, 0.9627047458913698, 0.9628276532348439, 0.9635623596041298, 0.9643736796139162,
                    0.9650871170119175, 0.9651522391124943, 0.9646443369404798, 0.9642636032605875, 0.9652428939463333,
                    0.9632218675326114, 0.96519783020193,   0.9647370145161072, 0.9646292400452141, 0.9646516517657894,
                    0.9656500035993556, 0.9648375409942396, 0.9642571763865291, 0.9659279162403309, 0.9646469192699545,
                    0.9639444339684713, 0.9656618730409042, 0.9658888823830692, 0.9643487518817399, 0.9656867013869198,
                    0.9652904364521923, 0.9656753622509984, 0.9652773694472715, 0.9654228913031919, 0.9646247092723206,
                    0.964809126309137,  0.9652884298483655, 0.9651930393440757, 0.9650146180926751, 0.9650841176387451,
                    0.9653401726905694, 0.9639685467901298, 0.9642820000252328, 0.9654293665732223, 0.9653692565373024,
                    0.9650359730160951, 0.9639184650513983, 0.9656620878664386, 0.9655662523683344, 0.9655383835951625,
                    ]

test_1_32_4_median = [0.9597367894665221, 0.9615636515683799, 0.9612868071734681, 0.9639230869865779, 0.9629915205285782,
                    0.9635784003966811, 0.9640838968015204, 0.9637049705364873, 0.9625969860811001, 0.9646818769851203,
                    0.9634307153976749, 0.9646321241841177, 0.9639320428905049, 0.9624446855756225, 0.963371468382653,
                    0.9646836990334952, 0.9643163078441919, 0.9633991260319344, 0.9646036312200195, 0.964196384653836,
                    0.9642918183704726, 0.9649627892246658, 0.9642702387134501, 0.9642717258675759, 0.9640938515147632,
                    0.9643197636469321, 0.9657680014984351, 0.9646081524705951, 0.9634483011683025, 0.9641145886414902,
                    0.9654466959809592, 0.9645746602238173, 0.963825746903286,  0.9648034652108584, 0.9649518585067538,
                    0.9634939550362089, 0.9646754218836661, 0.9646098436384458, 0.9650024899192846, 0.9638964677449002,
                    0.9635994970853271, 0.9659066046843081, 0.9649238497025077, 0.9639776232364539, 0.9643013075191298,
                    0.9641604222356785, 0.9640228178367676, 0.9635638261243017, 0.9645947963627939, 0.9651681689010605,
                    ]

test_1_64_4_median = [0.9500660829010216, 0.9611254224910619, 0.9608288631862985, 0.9627443110134639, 0.963448638179119,
                    0.9635159786162794, 0.9629237449767488, 0.9630708898667233, 0.9648345015071227, 0.9641765479172228,
                    0.9638048643913308, 0.9631895140247723, 0.9631291167366934, 0.9639162923336242, 0.9644974697115598,
                    0.9643428266044789, 0.9647193104594673, 0.9655114723832767, 0.9643278344448826, 0.9660908669431705,
                    0.9655446627912918, 0.9645295069936007, 0.9648076370843293, 0.9649508429645071, 0.9637900429366526,
                    0.9648151549604568, 0.964914815515505,  0.964362020903186,  0.9643865380721042, 0.9649198672122258,
                    0.9638368423301293, 0.9647328728111307, 0.963826292742815,  0.9647279117260772, 0.9641676573208414,
                    0.964248388217223,  0.9643263845932182, 0.9654748062206058, 0.9657058697973517, 0.9652482151520398,
                    0.9650448343150633, 0.9649003964477795, 0.9648676228062547, 0.9645152638550929, 0.9653171798176963,
                    0.964693971481037,  0.9639546485877735, 0.9652249582536073, 0.9654751938936365, 0.96468170740664,
                    ]

test_1_64_8_median = [0.959221633500949,  0.9625482474073135, 0.9626242855235136, 0.9630892614728042, 0.9633086705941336,
                    0.9637971351222552, 0.9627316904779242, 0.9630496045398218, 0.9638176591141421, 0.9584265723488072,
                    0.9640414361031497, 0.963455080502432,  0.9640259903771331, 0.962249035890148,  0.9642917766650732,
                    0.963383761361935,  0.9618922407270507, 0.962791382032113,  0.9642941484476057, 0.9629180022421275,
                    0.9646897121816873, 0.9643809973884621, 0.9637105255222109, 0.9636151380795688, 0.9629671240395434,
                    0.9644457129845012, 0.964562788861937,  0.963959971719001,  0.9631549173319438, 0.9637874025553489,
                    0.9640731231046047, 0.9642641490831653, 0.964475532834042,  0.9640857435933456, 0.9648317829920303,
                    0.9643884549843809, 0.9648043983905191, 0.9642994417105477, 0.9644352635827412, 0.9642922179333644,
                    0.9637009794985816, 0.9642617496659489, 0.9636471983704136, 0.9643927049050864, 0.9648446113072098,
                    0.963764955333845,  0.9645821172224865, 0.9637935433614477, 0.9635055943863224, 0.9634752745765014,
                    ]

test_1_128_4_median = [0.9503067263912974, 0.9587610240075473, 0.9615551333373925, 0.9612538334861518, 0.9623284337182569,
                     0.9638584102448791, 0.9620742375378903, 0.963076720864291,  0.9637083805533594, 0.961890356866649,
                     0.9644198460240248, 0.9636760108609648, 0.9647562663690348, 0.9631203710924805, 0.9645157074002668,
                     0.9641361357416736, 0.9640268458262633, 0.963858862248991,  0.96431433527009,   0.9649755971108374,
                     0.9656849262194855, 0.9657217061664367, 0.9636536134667738, 0.9650215917356537, 0.965137757994594,
                     0.9636561137390145, 0.9645745081640533, 0.964165637208244,  0.9646465843416634, 0.9648306163685052,
                     0.9637271768069735, 0.9650693898391041, 0.965370960928605,  0.9653626396833888, 0.9655128112831759,
                     0.964576155269902,  0.9639909384577426, 0.9648183429289034, 0.9654117757264874, 0.9650167121630118,
                     0.9658272224150404, 0.9641058427836209, 0.9651375588103287, 0.9651048969783793, 0.9658754933638081,
                     0.9651795466785681, 0.9652814332166607, 0.965152612525885,  0.9646962245650983, 0.9647606900284482,
                     ]

test_1_128_8_median = [0.9550559988119947, 0.9547401560081004, 0.9628448591143619, 0.9613749751972354, 0.9634778420925426,
                     0.9632633366249557, 0.9610542659629134, 0.9638695963973918, 0.9634644170026161, 0.9639208343361778,
                     0.9637661073438758, 0.9627948167691027, 0.9641132356601315, 0.9640509839872813, 0.9637352616988081,
                     0.9653508482464934, 0.963565909915354,  0.9648117110071841, 0.9651881710733474, 0.9647643833723927,
                     0.9645696860369993, 0.9638474190018358, 0.9636216117959687, 0.9648863336297333, 0.964479103188475,
                     0.9640694008839168, 0.9644421352767643, 0.9650718724483929, 0.9651477015338399, 0.9628995679151501,
                     0.9641593519365688, 0.9647016641908316, 0.9638323790499288, 0.9646100562936603, 0.9647321905146731,
                     0.9648086395432778, 0.9643616732759925, 0.9644607374905438, 0.9658190008118038, 0.9642026417752186,
                     0.9650674602868103, 0.9638635114052061, 0.9652802204504052, 0.964058060261163,  0.9648140017397167,
                     0.9649362244879571, 0.9644192260785542, 0.9653571768822357, 0.9643194379235713, 0.9647012559820234,
                     ]


# The number of epochs for the training.
x = np.arange(1, 51)

# Create the size of the figure.
fig=plt.figure(num=1,figsize=(20, 10))

# Set the size of subplot and starting point, set three styles for the plot
ax=fig.add_subplot(111)
ax.plot(x, test_1_16_1_median, "b--.", label="Median for Test-Human-N-SCE on Train-Human/Cyno-N, batch size=16, learning rate=0.0001")
#ax.plot(x, test_1_16_2_median, "r-x", label="Median for Testing-01 on Training-01, batch size=16, learning rate=0.0001")
ax.plot(x, test_1_32_2_median, "r-.^", label="Median for Test-Human-N-SCE on Train-Human/Cyno-N, batch size=32, learning rate=0.0002")
#ax.plot(x, test_1_32_4_median, "b:+", label="Median for Testing-01 on Training-01, batch size=16, learning rate=0.0001")
ax.plot(x, test_1_64_4_median, "y--+", label="Median for Test-Human-N-SCE on Train-Human/Cyno-N, batch size=64, learning rate=0.0004")
#ax.plot(x, test_1_64_8_median, "y-.,", label="Median for Testing-01 on Training-01, batch size=16, learning rate=0.0001")
ax.plot(x, test_1_128_8_median, "g-x", label="Median for Test-Human-N-SCE on Train-Human/Cyno-N, batch size=128, learning rate=0.0008")

# Set the scales for x-axis and y-axis.
ax.set_xlim([1, 50.1])
ax.set_ylim([0.95, 0.97])

# Set the scales for the display of x-axis and y-axis.
# np.linspace() is arithmetic progression， from 1 to 50
ax.set_xticks(np.linspace(1, 50, 50))
ax.set_yticks(np.linspace(0.95, 0.97, 3))

# Set the labels for the scales
ax.set_xticklabels(["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18",
                    "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34",
                    "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50"],
                   fontproperties="monospace", fontsize=12, rotation=10)
ax.set_yticklabels(["0.95", "0.96", "0.97"])

# Set the decorations for the scales and labels
ax.tick_params(left=False, pad=8, direction="in", length=2, width=3, color="b", labelsize=12)
ax.tick_params("x", labelrotation=10)

# Set the labels for x and y
ax.set_xlabel("Epochs", fontsize=16)
ax.set_ylabel("Cos Similarity", fontsize=16)

# Set the title
#ax.set_title("Figure for Epochs and Cosine Similarities. \n"
#             "Train-Human/Cyno-N, Test-Human-N-SCE.", fontsize=18,
#             backgroundcolor='#FFE6CC', fontweight='bold', color='black', verticalalignment="baseline")

# Set the spines
ax.spines["left"].set_color("darkblue")
ax.spines["bottom"].set_linewidth(2)

ax.spines["top"].set_visible(False)
ax.spines["right"].set_visible(False)
ax.spines["left"].set_visible(False)

# Set the annotations
#ax.annotate(s="Max:0.960398",xy=(17,0.94),xytext=(17.2,0.87),arrowprops=dict(facecolor="g",shrink=0.05,headwidth=12,
#                                                                          headlength=6, width=4),fontsize=12)
#ax.annotate(s="Min:0.421085",xy=(1,0.4),xytext=(1.2,0.33),arrowprops=dict(facecolor="b",shrink=0.05,headwidth=12,
#                                                                          headlength=6, width=4),fontsize=12)

# Set the legend
ax.legend(loc=3, labelspacing=1, handlelength=3, fontsize=14, shadow=True)

plt.show()